<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Goals Planner | JNG Tax & Advisory</title>
  <meta name="description" content="Comprehensive financial goals planner. Find the minimum monthly savings needed to meet all your financial goals — emergency fund, debt payoff, retirement, college savings, and more.">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;500;600;700&family=Source+Sans+3:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
:root {
  --navy: #1e3a5f;
  --navy-light: #2d5a8a;
  --navy-dark: #0f2440;
  --blue-accent: #3b7bbf;
  --cream: #faf8f5;
  --white: #ffffff;
  --gray-100: #f7f7f7;
  --gray-200: #e8e8e8;
  --gray-400: #999999;
  --gray-600: #666666;
  --gray-800: #333333;
  --text: #2a2a2a;
  --green: #2e7d32;
  --green-light: #e8f5e9;
  --red: #c62828;
  --red-light: #ffebee;
  --orange: #e65100;
  --orange-light: #fff3e0;
  --font-display: 'Playfair Display', Georgia, serif;
  --font-body: 'Source Sans 3', -apple-system, sans-serif;
  --max-width: 1200px;
  --transition: 0.3s ease;
}

*, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }
html { scroll-behavior: smooth; }
body {
  font-family: var(--font-body);
  font-size: 16px;
  line-height: 1.6;
  color: var(--text);
  background: var(--cream);
  -webkit-font-smoothing: antialiased;
}

h1, h2, h3, h4 {
  font-family: var(--font-display);
  font-weight: 500;
  line-height: 1.2;
  color: var(--navy-dark);
}

/* Header */
.site-header {
  position: fixed;
  top: 0; left: 0; right: 0;
  z-index: 1000;
  background: var(--white);
  border-bottom: 1px solid var(--gray-200);
  box-shadow: 0 2px 20px rgba(0,0,0,0.06);
}

.site-header nav {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 1rem 2rem;
  max-width: var(--max-width);
  margin: 0 auto;
}

.logo {
  display: flex;
  align-items: center;
  gap: 0.75rem;
  font-family: var(--font-display);
  font-size: 1.3rem;
  font-weight: 500;
  color: var(--navy);
  text-decoration: none;
}

.logo-icon {
  width: 36px; height: 36px;
  background: var(--navy);
  border-radius: 6px;
  display: flex;
  align-items: center;
  justify-content: center;
}

.logo-icon svg { width: 20px; height: 20px; fill: var(--white); }

.nav-links {
  display: flex;
  gap: 2.5rem;
  list-style: none;
  align-items: center;
}

.nav-links a {
  font-size: 0.95rem;
  font-weight: 500;
  color: var(--gray-600);
  text-transform: uppercase;
  letter-spacing: 0.05em;
  text-decoration: none;
  padding: 0.5rem 0;
  position: relative;
  transition: color var(--transition);
}

.nav-links a::after {
  content: '';
  position: absolute;
  bottom: 0; left: 0;
  width: 0; height: 2px;
  background: var(--navy);
  transition: width var(--transition);
}

.nav-links a:hover, .nav-links a.active { color: var(--navy); }
.nav-links a:hover::after, .nav-links a.active::after { width: 100%; }

.nav-cta {
  background: var(--navy) !important;
  color: var(--white) !important;
  padding: 0.65rem 1.25rem !important;
  border-radius: 4px;
  text-transform: none !important;
  letter-spacing: 0 !important;
}
.nav-cta::after { display: none !important; }
.nav-cta:hover { background: var(--navy-light) !important; }

.menu-toggle {
  display: none;
  flex-direction: column;
  gap: 5px;
  cursor: pointer;
  padding: 0.5rem;
  background: none;
  border: none;
}
.menu-toggle span {
  width: 25px; height: 2px;
  background: var(--navy);
  transition: var(--transition);
}

/* Loading Bar */
.loading-bar {
  position: fixed;
  top: 72px;
  left: 0;
  right: 0;
  height: 3px;
  background: linear-gradient(90deg, var(--blue-accent), var(--navy), var(--blue-accent));
  background-size: 200% 100%;
  animation: loading 1.5s ease-in-out infinite;
  z-index: 999;
}
@keyframes loading {
  0% { background-position: 200% 0; }
  100% { background-position: -200% 0; }
}

/* Slider */
.jng-slider {
  -webkit-appearance: none;
  width: 100%;
  height: 6px;
  border-radius: 3px;
  background: var(--gray-200);
  outline: none;
  cursor: pointer;
}
.jng-slider::-webkit-slider-thumb {
  -webkit-appearance: none;
  width: 20px; height: 20px;
  border-radius: 50%;
  background: var(--blue-accent);
  cursor: pointer;
  box-shadow: 0 2px 6px rgba(30,58,95,0.25);
  transition: transform 0.15s;
}
.jng-slider::-webkit-slider-thumb:hover { transform: scale(1.15); }
.jng-slider::-moz-range-thumb {
  width: 20px; height: 20px;
  border-radius: 50%;
  background: var(--blue-accent);
  cursor: pointer;
  border: none;
}

/* Footer */
.site-footer {
  background: var(--gray-100);
  padding: 3rem 0 1.5rem;
  border-top: 1px solid var(--gray-200);
}
.site-footer .container {
  max-width: var(--max-width);
  margin: 0 auto;
  padding: 0 2rem;
}
.footer-content {
  display: grid;
  grid-template-columns: 2fr 1fr 1fr;
  gap: 3rem;
  margin-bottom: 2rem;
}
.footer-brand p { color: var(--gray-600); max-width: 300px; margin-top: 0.75rem; font-size: 0.95rem; }
.footer-links h4 {
  font-family: var(--font-body);
  font-size: 0.85rem;
  font-weight: 600;
  text-transform: uppercase;
  letter-spacing: 0.1em;
  margin-bottom: 1rem;
  color: var(--gray-800);
}
.footer-links ul { list-style: none; }
.footer-links li { margin-bottom: 0.5rem; }
.footer-links a { color: var(--gray-600); text-decoration: none; font-size: 0.95rem; }
.footer-links a:hover { color: var(--navy); }
.footer-bottom {
  padding-top: 1.5rem;
  border-top: 1px solid var(--gray-200);
  display: flex;
  justify-content: space-between;
  font-size: 0.85rem;
  color: var(--gray-600);
}

/* Responsive */
@media (max-width: 900px) {
  .nav-links { display: none; }
  .nav-links.active {
    display: flex;
    flex-direction: column;
    position: absolute;
    top: 100%; left: 0; right: 0;
    background: var(--white);
    padding: 1rem 2rem;
    border-bottom: 1px solid var(--gray-200);
    gap: 0;
  }
  .nav-links.active li { padding: 0.75rem 0; }
  .menu-toggle { display: flex; }
  .footer-content { grid-template-columns: 1fr; gap: 2rem; }
  .footer-bottom { flex-direction: column; gap: 0.5rem; text-align: center; }
}
  </style>
</head>
<body>
  <!-- Header -->
  <header class="site-header" id="header">
    <nav>
      <a href="../index.html" class="logo">
        <div class="logo-icon">
          <svg viewBox="0 0 24 24"><rect x="4" y="14" width="4" height="6"/><rect x="10" y="10" width="4" height="10"/><rect x="16" y="6" width="4" height="14"/></svg>
        </div>
        JNG Tax & Advisory
      </a>
      <ul class="nav-links" id="nav-links">
        <li><a href="../index.html">Home</a></li>
        <li><a href="../pricing.html">Pricing</a></li>
        <li><a href="../about.html">About</a></li>
        <li><a href="../tools.html" class="active">Tools & Insights</a></li>
        <li><a href="https://calendly.com/jngtaxadvisory/15-minute-consultation" class="nav-cta" target="_blank">Get in Touch</a></li>
      </ul>
      <button class="menu-toggle" id="menu-toggle" aria-label="Menu">
        <span></span><span></span><span></span>
      </button>
    </nav>
  </header>

  <div id="root"></div>

  <script type="text/babel">
    const { useState, useEffect, useRef, useMemo } = React;

    // =============================================
    // DESIGN TOKENS (JNG)
    // =============================================
    const T = {
      navy: '#1e3a5f',
      navyLight: '#2d5a8a',
      navyDark: '#0f2440',
      blue: '#3b7bbf',
      cream: '#faf8f5',
      white: '#ffffff',
      g100: '#f7f7f7',
      g200: '#e8e8e8',
      g400: '#999999',
      g600: '#666666',
      g800: '#333333',
      text: '#2a2a2a',
      green: '#2e7d32',
      greenLt: '#e8f5e9',
      red: '#c62828',
      redLt: '#ffebee',
      orange: '#e65100',
      orangeLt: '#fff3e0',
      purple: '#5e35b1',
      purpleLt: '#ede7f6',
      fontDisplay: "'Playfair Display', Georgia, serif",
      fontBody: "'Source Sans 3', -apple-system, sans-serif",
    };

    const CP = ['#0f2440', '#1e3a5f', '#2d5a8a', '#3b7bbf', '#6fa3d4', '#a8cce6', '#d4e6f3'];

    const fmt = v => '$' + Math.round(v).toLocaleString();
    const fmtK = v => v >= 1e6 ? '$' + (v/1e6).toFixed(1) + 'M' : v >= 1e3 ? '$' + (v/1e3).toFixed(0) + 'K' : fmt(v);

    // =============================================
    // UI COMPONENTS
    // =============================================
    const Slider = ({ label, value, onChange, min, max, step = 1, unit = '$', desc }) => (
      <div style={{ marginBottom: 18 }}>
        <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'baseline', marginBottom: 4 }}>
          <span style={{ fontSize: 14, color: T.g600, fontWeight: 500 }}>{label}</span>
          <span style={{ fontSize: 17, fontWeight: 700, color: T.navy, fontFamily: T.fontBody }}>
            {unit === '$' ? fmt(value) : unit === '%' ? value.toFixed(1) + '%' : value + (unit || '')}
          </span>
        </div>
        {desc && <div style={{ fontSize: 12, color: T.g400, marginBottom: 4 }}>{desc}</div>}
        <input type="range" className="jng-slider" min={min} max={max} step={step} value={value}
          onChange={e => onChange(Number(e.target.value))} />
        <div style={{ display: 'flex', justifyContent: 'space-between', fontSize: 11, color: T.g400, marginTop: 2 }}>
          <span>{unit === '$' ? fmtK(min) : min}</span>
          <span>{unit === '$' ? fmtK(max) : max}</span>
        </div>
      </div>
    );

    const Toggle = ({ label, value, onChange, desc }) => (
      <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: 14 }}>
        <div>
          <span style={{ fontSize: 14, color: T.g600, fontWeight: 500 }}>{label}</span>
          {desc && <div style={{ fontSize: 12, color: T.g400 }}>{desc}</div>}
        </div>
        <button onClick={() => onChange(!value)}
          style={{ position: 'relative', width: 44, height: 24, borderRadius: 12, border: 'none',
            background: value ? T.blue : T.g200, cursor: 'pointer', transition: 'background 0.2s' }}>
          <span style={{ position: 'absolute', top: 3, width: 18, height: 18, borderRadius: 9,
            background: T.white, transition: 'left 0.15s', left: value ? 23 : 3,
            boxShadow: '0 1px 3px rgba(0,0,0,0.2)' }} />
        </button>
      </div>
    );

    const Card = ({ title, children, style = {} }) => (
      <div style={{ background: T.white, borderRadius: 8, padding: '20px 24px',
        boxShadow: '0 1px 8px rgba(0,0,0,0.06)', border: '1px solid ' + T.g200, ...style }}>
        {title && <h3 style={{ fontFamily: T.fontDisplay, fontSize: 18, fontWeight: 500,
          color: T.navyDark, marginBottom: 16, paddingBottom: 10,
          borderBottom: '1px solid ' + T.g200 }}>{title}</h3>}
        {children}
      </div>
    );

    const Metric = ({ label, value, highlight, sub, color }) => (
      <div style={{ padding: '14px 16px', borderRadius: 6, textAlign: 'center',
        background: highlight ? T.navy : T.g100,
        border: highlight ? 'none' : '1px solid ' + T.g200 }}>
        <div style={{ fontSize: 22, fontWeight: 700, color: highlight ? T.white : (color || T.navy),
          fontFamily: T.fontBody }}>{value}</div>
        <div style={{ fontSize: 12, color: highlight ? 'rgba(255,255,255,0.8)' : T.g600,
          marginTop: 2 }}>{label}</div>
        {sub && <div style={{ fontSize: 11, color: highlight ? 'rgba(255,255,255,0.6)' : T.g400,
          marginTop: 2 }}>{sub}</div>}
      </div>
    );

    const ChartCanvas = ({ type, data, options, height = 220 }) => {
      const ref = useRef(null);
      const chartRef = useRef(null);
      useEffect(() => {
        if (chartRef.current) chartRef.current.destroy();
        chartRef.current = new window.Chart(ref.current.getContext('2d'), { type, data, options });
        return () => chartRef.current?.destroy();
      }, [JSON.stringify(data)]);
      return <div style={{ height }}><canvas ref={ref} /></div>;
    };

    // =============================================
    // MAIN PLANNER
    // =============================================
    const GoalsPlanner = () => {
      // Input state
      const [income, setIncome] = useState(95000);
      const [married, setMarried] = useState(false);
      const [emergencyBal, setEmergencyBal] = useState(2000);
      const [emergencyMonths, setEmergencyMonths] = useState(3);
      const [ccBal, setCcBal] = useState(8000);
      const [ccApr, setCcApr] = useState(22);
      const [ccPayoffYears, setCcPayoffYears] = useState(2);
      const [slBal, setSlBal] = useState(35000);
      const [slApr, setSlApr] = useState(6.5);
      const [slPayoffYears, setSlPayoffYears] = useState(10);
      const [autoBal, setAutoBal] = useState(12000);
      const [autoApr, setAutoApr] = useState(7.5);
      const [autoPayoffYears, setAutoPayoffYears] = useState(4);
      const [currentAge, setCurrentAge] = useState(35);
      const [retireAge, setRetireAge] = useState(65);
      const [retireIncomePct, setRetireIncomePct] = useState(80);
      const [lifeExpectancy, setLifeExpectancy] = useState(90);
      const [retirementBal, setRetirementBal] = useState(45000);
      const [has401k, setHas401k] = useState(true);
      const [matchPercent, setMatchPercent] = useState(50);
      const [matchUpTo, setMatchUpTo] = useState(6);
      const [hasKids, setHasKids] = useState(true);
      const [numKids, setNumKids] = useState(2);
      const [kidAges, setKidAges] = useState([10, 6, 0, 0, 0]);
      const [collegeCostYear, setCollegeCostYear] = useState(40000);
      const [collegeYears, setCollegeYears] = useState(4);
      const [collegeBal, setCollegeBal] = useState(5000);
      const [useFinancialAid, setUseFinancialAid] = useState(false);
      const [aidPercent, setAidPercent] = useState(25);
      const [brokerageBal, setBrokerageBal] = useState(3000);

      // Results state
      const [results, setResults] = useState(null);
      const [loading, setLoading] = useState(false);
      const debounceRef = useRef(null);

      const updateKidAge = (i, v) => { const a = [...kidAges]; a[i] = v; setKidAges(a); };

      // =============================================
      // API CALL (debounced)
      // =============================================
      useEffect(() => {
        clearTimeout(debounceRef.current);
        debounceRef.current = setTimeout(async () => {
          setLoading(true);
          try {
            const res = await fetch('/.netlify/functions/goals-calculate', {
              method: 'POST',
              headers: { 'Content-Type': 'application/json' },
              body: JSON.stringify({
                income, married,
                emergencyBal, emergencyMonths,
                ccBal, ccApr, ccPayoffYears,
                slBal, slApr, slPayoffYears,
                autoBal, autoApr, autoPayoffYears,
                currentAge, retireAge, retireIncomePct, lifeExpectancy,
                retirementBal, has401k, matchPercent, matchUpTo,
                hasKids, numKids, kidAges: kidAges.slice(0, numKids),
                collegeCostYear, collegeYears, collegeBal,
                useFinancialAid, aidPercent,
                brokerageBal
              })
            });
            const data = await res.json();
            setResults(data);
          } catch (e) {
            console.error('Calculation error:', e);
          }
          setLoading(false);
        }, 250);
      }, [income, married, emergencyBal, emergencyMonths, retirementBal, collegeBal, brokerageBal,
        ccBal, ccApr, ccPayoffYears, slBal, slApr, slPayoffYears, autoBal, autoApr, autoPayoffYears,
        currentAge, retireAge, retireIncomePct, lifeExpectancy, has401k, matchPercent, matchUpTo,
        hasKids, numKids, kidAges, collegeCostYear, collegeYears, useFinancialAid, aidPercent]);

      // Sections toggle
      const [openSections, setOpenSections] = useState({ income: true, emergency: true, debts: true, retirement: true, college: true });
      const toggleSection = (s) => setOpenSections(prev => ({ ...prev, [s]: !prev[s] }));

      const SectionHeader = ({ id, title }) => (
        <div onClick={() => toggleSection(id)} style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center',
          cursor: 'pointer', padding: '14px 20px', background: T.navy, borderRadius: openSections[id] ? '8px 8px 0 0' : 8,
          transition: 'border-radius 0.2s' }}>
          <h3 style={{ fontFamily: T.fontDisplay, fontSize: 16, fontWeight: 500, color: T.white, margin: 0, padding: 0, border: 'none' }}>{title}</h3>
          <span style={{ color: 'rgba(255,255,255,0.7)', fontSize: 18, transition: 'transform 0.2s',
            transform: openSections[id] ? 'rotate(180deg)' : 'rotate(0)' }}>&#9662;</span>
        </div>
      );

      const SectionBody = ({ id, children }) => (
        <div style={{ display: openSections[id] ? 'block' : 'none', background: T.white, padding: '18px 20px',
          borderRadius: '0 0 8px 8px', border: '1px solid ' + T.g200, borderTop: 'none' }}>
          {children}
        </div>
      );

      // Chart data
      const chartData = useMemo(() => {
        if (!results?.timeline || results.timeline.length < 2) return null;
        const tl = results.timeline;
        return {
          labels: tl.map(t => t.age <= 100 ? `Age ${t.age}` : ''),
          datasets: [
            { label: 'Net Worth', data: tl.map(t => t.netWorth), borderColor: T.navy, backgroundColor: T.navy + '18', fill: true, tension: 0.3, pointRadius: 0, borderWidth: 2.5 },
            { label: 'Retirement', data: tl.map(t => t.retirement), borderColor: T.blue, backgroundColor: 'transparent', tension: 0.3, pointRadius: 0, borderWidth: 1.5, borderDash: [6, 3] },
          ]
        };
      }, [results?.timeline]);

      const chartOpts = {
        responsive: true, maintainAspectRatio: false,
        plugins: { legend: { position: 'bottom', labels: { font: { family: "'Source Sans 3'" }, usePointStyle: true, padding: 16 } } },
        scales: {
          x: { grid: { display: false }, ticks: { font: { size: 11 }, maxTicksLimit: 10 } },
          y: { grid: { color: '#e8e8e8' }, ticks: { font: { size: 11 }, callback: v => fmtK(v) } }
        }
      };

      const retireChartData = results ? {
        labels: ['Social Security', 'From Savings'],
        datasets: [{ data: [results.ssAnnual || 0, results.incomeNeededAnnual || 0], backgroundColor: [T.blue, T.navy], borderWidth: 0 }]
      } : null;

      const pieOpts = {
        responsive: true, maintainAspectRatio: false,
        plugins: { legend: { position: 'bottom', labels: { font: { family: "'Source Sans 3'" }, usePointStyle: true, padding: 12 } } }
      };

      return (
        <div style={{ minHeight: '100vh', background: T.cream, paddingTop: 80 }}>
          {loading && <div className="loading-bar" />}

          {/* Hero */}
          <div style={{ background: `linear-gradient(135deg, ${T.cream} 0%, ${T.white} 100%)`, padding: '48px 24px 36px', borderBottom: '1px solid ' + T.g200 }}>
            <div style={{ maxWidth: 1200, margin: '0 auto' }}>
              <p style={{ fontSize: 13, fontWeight: 600, textTransform: 'uppercase', letterSpacing: '0.15em', color: T.blue, marginBottom: 12 }}>Financial Planning Tool</p>
              <h1 style={{ fontFamily: T.fontDisplay, fontSize: 'clamp(1.8rem, 4vw, 2.6rem)', fontWeight: 500, color: T.navyDark, marginBottom: 8 }}>Goals Planner</h1>
              <p style={{ fontSize: 16, color: T.g600, maxWidth: 600 }}>
                Enter your financial picture below. The optimizer finds the minimum monthly savings needed to meet all your goals simultaneously.
              </p>
            </div>
          </div>

          {/* Dashboard Summary */}
          <div style={{ maxWidth: 1200, margin: '0 auto', padding: '24px 24px 0' }}>
            <div style={{ display: 'grid', gridTemplateColumns: 'repeat(auto-fit, minmax(180px, 1fr))', gap: 12, marginBottom: 24, opacity: loading ? 0.7 : 1, transition: 'opacity 0.2s' }}>
              <Metric label="Minimum Monthly Savings" value={results ? fmt(results.minimumMonthly) : '—'} highlight />
              <Metric label="Savings Rate" value={results ? results.savingsRate.toFixed(1) + '%' : '—'} sub={results ? `of ${fmt(results.afterTaxMonthly)}/mo after tax` : ''} />
              <Metric label="Optimizer Savings" value={results ? fmt(results.efficiencySavings) + '/mo' : '—'}
                sub={results ? `vs. ${fmt(results.naiveTotalMonthly)} individual total` : ''} color={T.green} />
              <Metric label="Current Net Worth" value={results ? fmtK(results.netWorth) : '—'}
                color={results?.netWorth >= 0 ? T.green : T.red} />
            </div>
          </div>

          {/* Main layout: Inputs + Charts */}
          <div style={{ maxWidth: 1200, margin: '0 auto', padding: '0 24px 48px',
            display: 'grid', gridTemplateColumns: '380px 1fr', gap: 24, alignItems: 'start' }}>

            {/* LEFT: Input Panels */}
            <div style={{ display: 'flex', flexDirection: 'column', gap: 12 }}>

              {/* Income */}
              <div>
                <SectionHeader id="income" title="Income & Profile" />
                <SectionBody id="income">
                  <Slider label="Annual Gross Income" value={income} onChange={setIncome} min={30000} max={500000} step={2000} />
                  <Toggle label="Married / Filing Jointly" value={married} onChange={setMarried} desc="Affects Social Security benefit" />
                  <div style={{ fontSize: 12, color: T.g400, padding: '8px 10px', background: T.g100, borderRadius: 4 }}>
                    Effective tax rate: 28% · After-tax monthly: {results ? fmt(results.afterTaxMonthly) : '—'}
                  </div>
                </SectionBody>
              </div>

              {/* Emergency */}
              <div>
                <SectionHeader id="emergency" title="Emergency Fund" />
                <SectionBody id="emergency">
                  <Slider label="Current Emergency Savings" value={emergencyBal} onChange={setEmergencyBal} min={0} max={100000} step={250} />
                  <Slider label="Months of Expenses" value={emergencyMonths} onChange={setEmergencyMonths} min={1} max={12} unit=" mo" />
                  <div style={{ fontSize: 12, color: T.g400, padding: '8px 10px', background: T.g100, borderRadius: 4 }}>
                    Target: {results ? fmt(results.emergencyTarget) : '—'} · Gap: {results ? fmt(results.emergencyGap) : '—'}
                  </div>
                </SectionBody>
              </div>

              {/* Debts */}
              <div>
                <SectionHeader id="debts" title="Debts" />
                <SectionBody id="debts">
                  <div style={{ marginBottom: 16 }}>
                    <div style={{ fontSize: 13, fontWeight: 600, color: T.navyDark, marginBottom: 8 }}>Credit Card</div>
                    <Slider label="Balance" value={ccBal} onChange={setCcBal} min={0} max={50000} step={250} />
                    <Slider label="APR" value={ccApr} onChange={setCcApr} min={0} max={30} step={0.1} unit="%" />
                    <Slider label="Payoff Target" value={ccPayoffYears} onChange={setCcPayoffYears} min={1} max={7} unit=" yr" />
                  </div>
                  <div style={{ marginBottom: 16 }}>
                    <div style={{ fontSize: 13, fontWeight: 600, color: T.navyDark, marginBottom: 8 }}>Auto Loan</div>
                    <Slider label="Balance" value={autoBal} onChange={setAutoBal} min={0} max={60000} step={250} />
                    <Slider label="APR" value={autoApr} onChange={setAutoApr} min={0} max={15} step={0.1} unit="%" />
                    <Slider label="Payoff Target" value={autoPayoffYears} onChange={setAutoPayoffYears} min={1} max={7} unit=" yr" />
                  </div>
                  <div>
                    <div style={{ fontSize: 13, fontWeight: 600, color: T.navyDark, marginBottom: 8 }}>Student Loan</div>
                    <Slider label="Balance" value={slBal} onChange={setSlBal} min={0} max={200000} step={500} />
                    <Slider label="APR" value={slApr} onChange={setSlApr} min={0} max={12} step={0.1} unit="%" />
                    <Slider label="Payoff Target" value={slPayoffYears} onChange={setSlPayoffYears} min={1} max={25} unit=" yr" />
                  </div>
                  {results?.totalDebt > 0 && (
                    <div style={{ fontSize: 12, color: T.g400, padding: '8px 10px', background: T.g100, borderRadius: 4, marginTop: 12 }}>
                      Total debt: {fmt(results.totalDebt)} · Total interest: {fmt(results.totalDebtInterest)} · Monthly: {fmt(results.totalDebtPmt)}
                    </div>
                  )}
                </SectionBody>
              </div>

              {/* Retirement */}
              <div>
                <SectionHeader id="retirement" title="Retirement" />
                <SectionBody id="retirement">
                  <Slider label="Current Age" value={currentAge} onChange={setCurrentAge} min={18} max={70} unit="" />
                  <Slider label="Retirement Age" value={retireAge} onChange={setRetireAge} min={50} max={75} unit="" />
                  <Slider label="Income Replacement" value={retireIncomePct} onChange={setRetireIncomePct} min={50} max={100} unit="%" desc="Percent of current income needed in retirement" />
                  <Slider label="Life Expectancy" value={lifeExpectancy} onChange={setLifeExpectancy} min={70} max={100} unit="" />
                  <Slider label="Current Retirement Savings" value={retirementBal} onChange={setRetirementBal} min={0} max={2000000} step={2500} />
                  <Toggle label="Have 401(k)" value={has401k} onChange={setHas401k} />
                  {has401k && (
                    <>
                      <Slider label="Employer Match" value={matchPercent} onChange={setMatchPercent} min={0} max={100} unit="%" desc="% of your contribution matched" />
                      <Slider label="Match Up To" value={matchUpTo} onChange={setMatchUpTo} min={0} max={15} step={0.1} unit="%" desc="% of salary eligible for match" />
                    </>
                  )}
                  <div style={{ fontSize: 12, color: T.g400, padding: '8px 10px', background: T.g100, borderRadius: 4, marginTop: 4 }}>
                    Social Security (est.): {results ? fmt(results.ssBenefit) : '—'}/mo · Retirement target: {results ? fmtK(results.retireTarget) : '—'} · Gap: {results ? fmtK(results.retireGap) : '—'}
                  </div>
                </SectionBody>
              </div>

              {/* College */}
              <div>
                <SectionHeader id="college" title="College Savings" />
                <SectionBody id="college">
                  <Toggle label="Saving for College" value={hasKids} onChange={setHasKids} />
                  {hasKids && (
                    <>
                      <Slider label="Number of Children" value={numKids} onChange={setNumKids} min={1} max={5} unit="" />
                      {Array.from({ length: numKids }).map((_, i) => (
                        <Slider key={i} label={`Child ${i + 1} Age`} value={kidAges[i] || 0} onChange={v => updateKidAge(i, v)} min={0} max={17} unit="" />
                      ))}
                      <Slider label="Annual Cost (today's dollars)" value={collegeCostYear} onChange={setCollegeCostYear} min={10000} max={100000} step={500} />
                      <Slider label="Years of School" value={collegeYears} onChange={setCollegeYears} min={1} max={6} unit=" yr" />
                      <Slider label="Current 529 / Savings" value={collegeBal} onChange={setCollegeBal} min={0} max={200000} step={500} />
                      <Toggle label="Expect Financial Aid" value={useFinancialAid} onChange={setUseFinancialAid} />
                      {useFinancialAid && (
                        <Slider label="Estimated Aid Coverage" value={aidPercent} onChange={setAidPercent} min={5} max={75} step={1} unit="%" />
                      )}
                      <div style={{ fontSize: 12, color: T.g400, padding: '8px 10px', background: T.g100, borderRadius: 4, marginTop: 4 }}>
                        Total monthly needed: {results ? fmt(results.totalCollegeMonthly) : '—'} (5% college inflation applied)
                      </div>
                    </>
                  )}
                </SectionBody>
              </div>

              {/* Brokerage */}
              <Card title="Brokerage / Taxable" style={{ marginTop: 4 }}>
                <Slider label="Current Balance" value={brokerageBal} onChange={setBrokerageBal} min={0} max={500000} step={500} />
                <div style={{ fontSize: 12, color: T.g400 }}>Overflow savings go here after all goals are funded.</div>
              </Card>
            </div>

            {/* RIGHT: Results */}
            <div style={{ display: 'flex', flexDirection: 'column', gap: 16, opacity: loading ? 0.7 : 1, transition: 'opacity 0.2s' }}>

              {/* How it works */}
              <Card style={{ background: T.navyDark, border: 'none' }}>
                <div style={{ color: 'rgba(255,255,255,0.85)', fontSize: 14, lineHeight: 1.6 }}>
                  <strong style={{ color: T.white }}>How the Optimizer Works</strong>
                  <div style={{ marginTop: 8 }}>
                    Your savings are allocated in priority order: emergency fund first, then high-interest debt (avalanche method),
                    401(k) up to employer match, college savings, additional retirement, and finally taxable brokerage.
                    As short-term goals complete, those dollars cascade to remaining goals — meaning
                    you need <em>less</em> than the sum of individual requirements.
                  </div>
                </div>
              </Card>

              {/* Allocation Breakdown */}
              {results && (
                <Card title="Monthly Allocation Priority">
                  <div style={{ display: 'flex', flexDirection: 'column', gap: 8 }}>
                    {results.emergencyGap > 0 && (
                      <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', padding: '8px 12px', background: T.g100, borderRadius: 6 }}>
                        <div style={{ display: 'flex', alignItems: 'center', gap: 8 }}>
                          <div style={{ width: 10, height: 10, borderRadius: '50%', background: T.green }} />
                          <span style={{ fontSize: 14, color: T.text }}>Emergency Fund</span>
                        </div>
                        <span style={{ fontSize: 14, fontWeight: 600, color: T.navy }}>{fmt(results.emergencyMonthlyContrib)}/mo</span>
                      </div>
                    )}
                    {results.debts?.map((d, i) => (
                      <div key={i} style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', padding: '8px 12px', background: T.g100, borderRadius: 6 }}>
                        <div style={{ display: 'flex', alignItems: 'center', gap: 8 }}>
                          <div style={{ width: 10, height: 10, borderRadius: '50%', background: d.color }} />
                          <span style={{ fontSize: 14, color: T.text }}>{d.name} ({(d.apr * 100).toFixed(1)}%)</span>
                        </div>
                        <span style={{ fontSize: 14, fontWeight: 600, color: T.navy }}>{fmt(d.monthlyPmt)}/mo</span>
                      </div>
                    ))}
                    {has401k && results.monthlyMatchableContrib > 0 && (
                      <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', padding: '8px 12px', background: T.g100, borderRadius: 6 }}>
                        <div style={{ display: 'flex', alignItems: 'center', gap: 8 }}>
                          <div style={{ width: 10, height: 10, borderRadius: '50%', background: T.blue }} />
                          <span style={{ fontSize: 14, color: T.text }}>401(k) to Match</span>
                        </div>
                        <span style={{ fontSize: 14, fontWeight: 600, color: T.navy }}>{fmt(results.monthlyMatchableContrib)}/mo
                          <span style={{ fontSize: 11, color: T.green, marginLeft: 4 }}>+{fmt(results.monthlyMatchReceived)} match</span>
                        </span>
                      </div>
                    )}
                    {results.collegeGoals?.map((c, i) => (
                      <div key={i} style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', padding: '8px 12px', background: T.g100, borderRadius: 6 }}>
                        <div style={{ display: 'flex', alignItems: 'center', gap: 8 }}>
                          <div style={{ width: 10, height: 10, borderRadius: '50%', background: CP[3 + i] || CP[4] }} />
                          <span style={{ fontSize: 14, color: T.text }}>College — Child {c.childNum} (age {c.age})</span>
                        </div>
                        <span style={{ fontSize: 14, fontWeight: 600, color: T.navy }}>{fmt(c.monthly)}/mo</span>
                      </div>
                    ))}
                    <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', padding: '8px 12px', background: T.g100, borderRadius: 6 }}>
                      <div style={{ display: 'flex', alignItems: 'center', gap: 8 }}>
                        <div style={{ width: 10, height: 10, borderRadius: '50%', background: T.navyLight }} />
                        <span style={{ fontSize: 14, color: T.text }}>Additional Retirement</span>
                      </div>
                      <span style={{ fontSize: 14, fontWeight: 600, color: T.navy }}>remainder</span>
                    </div>
                  </div>
                </Card>
              )}

              {/* Net Worth Projection */}
              {chartData && (
                <Card title="Net Worth & Retirement Projection">
                  <ChartCanvas type="line" data={chartData} options={chartOpts} height={260} />
                </Card>
              )}

              {/* Retirement Income Breakdown */}
              {retireChartData && results && (
                <Card title="Retirement Income Sources">
                  <div style={{ display: 'grid', gridTemplateColumns: '140px 1fr', gap: 16, alignItems: 'center' }}>
                    <ChartCanvas type="doughnut" data={retireChartData} options={pieOpts} height={140} />
                    <div style={{ display: 'flex', flexDirection: 'column', gap: 8 }}>
                      <div>
                        <div style={{ fontSize: 12, color: T.g600 }}>Desired Annual Income</div>
                        <div style={{ fontSize: 18, fontWeight: 700, color: T.navy }}>{fmt(results.retireIncomeAnnual)}</div>
                      </div>
                      <div>
                        <div style={{ fontSize: 12, color: T.g600 }}>Est. Social Security</div>
                        <div style={{ fontSize: 16, fontWeight: 600, color: T.blue }}>{fmt(results.ssBenefit)}/mo ({fmtK(results.ssAnnual)}/yr)</div>
                      </div>
                      <div>
                        <div style={{ fontSize: 12, color: T.g600 }}>From Savings</div>
                        <div style={{ fontSize: 16, fontWeight: 600, color: T.navyDark }}>{fmtK(results.incomeNeededAnnual)}/yr</div>
                      </div>
                      <div>
                        <div style={{ fontSize: 12, color: T.g600 }}>Growth Rate Applied</div>
                        <div style={{ fontSize: 14, color: T.g800 }}>{(results.accumulationROR * 100).toFixed(0)}% accumulation · 4% withdrawal</div>
                      </div>
                    </div>
                  </div>
                </Card>
              )}

              {/* Year-by-Year Timeline */}
              {results?.timeline?.length > 0 && (
                <Card title="Year-by-Year Timeline">
                  <div style={{ overflowX: 'auto' }}>
                    <table style={{ width: '100%', borderCollapse: 'collapse', fontSize: 13 }}>
                      <thead>
                        <tr style={{ borderBottom: '2px solid ' + T.g200 }}>
                          {['Year', 'Age', 'Emergency', 'Debt', 'Retirement', 'College', 'Net Worth'].map(h => (
                            <th key={h} style={{ textAlign: h === 'Year' || h === 'Age' ? 'left' : 'right', padding: '8px 10px', color: T.g600, fontWeight: 600, fontSize: 11, textTransform: 'uppercase', letterSpacing: '0.05em' }}>{h}</th>
                          ))}
                        </tr>
                      </thead>
                      <tbody>
                        {results.timeline.filter((_, i) => i % 2 === 0 || i === results.timeline.length - 1).slice(0, 20).map((t, i) => (
                          <tr key={i} style={{ borderBottom: '1px solid ' + T.g200 }}>
                            <td style={{ padding: '6px 10px', fontWeight: 500, color: T.navyDark }}>{t.year}</td>
                            <td style={{ padding: '6px 10px', color: T.g600 }}>{t.age}</td>
                            <td style={{ padding: '6px 10px', textAlign: 'right', color: t.emergency >= (results.emergencyTarget || 0) ? T.green : T.text }}>{fmtK(t.emergency)}</td>
                            <td style={{ padding: '6px 10px', textAlign: 'right', color: t.totalDebt === 0 ? T.green : T.red }}>{fmtK(t.totalDebt)}</td>
                            <td style={{ padding: '6px 10px', textAlign: 'right', color: T.navy, fontWeight: 500 }}>{fmtK(t.retirement)}</td>
                            <td style={{ padding: '6px 10px', textAlign: 'right', color: T.blue }}>{fmtK(t.college)}</td>
                            <td style={{ padding: '6px 10px', textAlign: 'right', fontWeight: 600, color: t.netWorth >= 0 ? T.navy : T.red }}>{fmtK(t.netWorth)}</td>
                          </tr>
                        ))}
                      </tbody>
                    </table>
                  </div>
                </Card>
              )}

              {/* CTA */}
              <div style={{ background: `linear-gradient(135deg, ${T.navy} 0%, ${T.navyDark} 100%)`, borderRadius: 8, padding: '32px 28px', textAlign: 'center' }}>
                <h3 style={{ fontFamily: T.fontDisplay, color: T.white, fontSize: 20, marginBottom: 8 }}>Want personalized guidance?</h3>
                <p style={{ color: 'rgba(255,255,255,0.8)', fontSize: 15, marginBottom: 20, maxWidth: 400, margin: '0 auto 20px' }}>
                  This tool shows what's possible. A consultation can help you build a plan tailored to your exact situation.
                </p>
                <a href="https://calendly.com/jngtaxadvisory/15-minute-consultation" target="_blank"
                  style={{ display: 'inline-block', background: T.white, color: T.navy, padding: '12px 28px', borderRadius: 4,
                    fontFamily: T.fontBody, fontSize: 15, fontWeight: 600, textDecoration: 'none', transition: 'all 0.3s' }}>
                  Free 15-Minute Consult →
                </a>
              </div>

              {/* Disclaimer */}
              <div style={{ fontSize: 12, color: T.g400, lineHeight: 1.6, padding: '0 4px' }}>
                <strong>Disclaimer:</strong> This calculator provides estimates for educational purposes only and does not constitute financial,
                tax, or investment advice. Calculations use simplified assumptions including a flat 28% effective tax rate,
                time-horizon-based returns (3%/5%/7%), 2025 Social Security bend points, and 5% college cost inflation.
                All projections shown in today's dollars — update annually with current balances for best accuracy.
                Actual results will vary. Consult a qualified professional before making financial decisions.
              </div>
            </div>
          </div>

          {/* Responsive override for mobile */}
          <style>{`
            @media (max-width: 900px) {
              [style*="grid-template-columns: 380px"] {
                grid-template-columns: 1fr !important;
              }
            }
          `}</style>

          {/* Footer */}
          <footer className="site-footer">
            <div className="container">
              <div className="footer-content">
                <div className="footer-brand">
                  <a href="../index.html" className="logo">
                    <div className="logo-icon" style={{ width: 30, height: 30 }}>
                      <svg viewBox="0 0 24 24" style={{ width: 16, height: 16 }}><rect x="4" y="14" width="4" height="6" fill="white"/><rect x="10" y="10" width="4" height="10" fill="white"/><rect x="16" y="6" width="4" height="14" fill="white"/></svg>
                    </div>
                    JNG Tax & Advisory
                  </a>
                  <p>Tax planning and preparation for professionals and small businesses in Monmouth County, NJ.</p>
                </div>
                <div className="footer-links">
                  <h4>Quick Links</h4>
                  <ul>
                    <li><a href="../index.html">Home</a></li>
                    <li><a href="../pricing.html">Pricing</a></li>
                    <li><a href="../about.html">About</a></li>
                    <li><a href="../tools.html">Tools & Insights</a></li>
                  </ul>
                </div>
                <div className="footer-links">
                  <h4>Contact</h4>
                  <ul>
                    <li><a href="tel:7324408290">(732) 440-8290</a></li>
                    <li><a href="mailto:neill@jngtaxadvisory.com">neill@jngtaxadvisory.com</a></li>
                    <li>Shrewsbury, NJ</li>
                  </ul>
                </div>
              </div>
              <div className="footer-bottom">
                <p>© 2026 JNG Tax & Advisory. All rights reserved.</p>
                <p>CFA® | Enrolled Agent | IRS PTIN Holder</p>
              </div>
            </div>
          </footer>
        </div>
      );
    };

    ReactDOM.createRoot(document.getElementById('root')).render(<GoalsPlanner />);
  </script>

  <script>
    document.getElementById('menu-toggle').addEventListener('click', () => {
      document.getElementById('nav-links').classList.toggle('active');
    });
  </script>
</body>
</html>
